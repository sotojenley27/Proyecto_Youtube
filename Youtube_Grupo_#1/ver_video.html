
<!doctype html><html lang="es"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ver video - YouTube Grupo1</title>
<link rel="stylesheet" href="style.css">
</head><body>

<header>
  <div class="logo">YouTube <span>Grupo1</span></div>
  <div style="margin-left:auto"></div>
  <button class="btn outline" onclick="logout()">Salir</button>
</header>
<div class="container">
  <aside>
    <div style="margin-bottom:8px;font-weight:700" id="side-name">Mi Canal</div>
    <a href="home.html">üè† Home</a>
    <a href="subir_video.html">‚ûï Subir video</a>
    <a href="crear_canal.html">‚ú® Crear/Editar canal</a>
    <a href="mi_canal.html">üìÑ Mi canal</a>
  </aside>
  <main>

<div class="section">
  <div id="player" class="section" style="padding:0;border:none">
    <!-- player here -->
  </div>
  <div class="section">
    <h2 id="vtitle"></h2>
    <div class="meta" id="vmeta"></div>
    <p class="info" id="vdesc"></p>
  </div>

  <div class="section">
    <h3>Comentarios</h3>
    <form id="cform">
      <label>Tu comentario</label>
      <textarea name="text" required placeholder="Escribe aqu√≠..."></textarea>
      <button class="btn" style="margin-top:6px">Publicar</button>
    </form>
    <div id="clist"></div>
  </div>
</div>

<aside class="section" style="margin-top:16px">
  <h3>Recomendados</h3>
  <div id="recs"></div>
</aside>

  </main>
</div>
<script src="script.js"></script>

<script>
  const me = requireAuth(); if(!me){}; fillSidebar(me);
  const params = new URLSearchParams(location.search);
  const id = params.get('id');
  const video = allVideos().find(v => v.id === id) || allVideos()[0];

  if((video.src||'').includes('youtube.com/embed')){
    document.getElementById('player').innerHTML = `<iframe src="${video.src}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen style="width:100%;height:60vh"></iframe>`;
  }else{
    document.getElementById('player').innerHTML = `<video controls src="${video.src}" style="width:100%;height:60vh"></video>`;
  }
  document.getElementById('vtitle').textContent = video.title;
  document.getElementById('vmeta').textContent = (video.channel||'') + ' ‚Ä¢ ' + (fmtViews(video.views||0)) + ' vistas';
  document.getElementById('vdesc').textContent = video.desc || '';

  // recomendados
  const recs = document.getElementById('recs');
  allVideos().filter(v=>v.id!==video.id).slice(0,8).forEach(v=>{
    const a=document.createElement('a');
    a.href='ver_video.html?id='+encodeURIComponent(v.id);
    a.style.display='grid';
    a.style.gridTemplateColumns='150px 1fr';
    a.style.gap='8px'; a.style.margin='8px 0';
    a.innerHTML=`<img class="thumb" style="height:90px" src="${v.thumb}"><div><div class="title" style="-webkit-line-clamp:2">${v.title}</div><div class="meta">${v.channel}</div></div>`;
    recs.appendChild(a);
  });

  // comentarios
  const clist = document.getElementById('clist');
  function renderC(){
    clist.innerHTML='';
    listComments(id).slice().reverse().forEach(c=>{
      const div=document.createElement('div');
      div.className='comment';
      div.innerHTML=`<strong>${c.user}</strong> <span class="meta">‚Ä¢ ${new Date(c.ts).toLocaleString()}</span><p>${c.text}</p>`;
      clist.appendChild(div);
    });
  }
  renderC();
  document.getElementById('cform').addEventListener('submit', (e)=>{
    e.preventDefault();
    const text = e.target.text.value.trim(); if(!text) return;
    addComment(id, {user: me, text, ts: Date.now()});
    e.target.reset(); renderC();
  });
</script>
</body></html>
